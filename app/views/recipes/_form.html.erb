<%= render 'shared/flash' %>

<main>
  <div class="container">

    <div class="row my-4">
      <div class="col-md-7 px-sm-0 d-flex align-self-center">
        <%= form_with(model: @recipe, local: true) do |f| %>
          <%= f.hidden_field :image_cache %>

          <div class="cooking-title">写真</div>
          <label class="img-file">
            <i class="fa-solid fa-camera" style="color: #000000;"></i>
            <%= f.file_field :image, accept: "image/jpeg,image/gif,image/png", class: "image" %>
          </label>
          <div class="preview description__preview"></div>
          <div class="description__img set-img">
            <%= image_tag recipe.image.url, size: "450x300" %>
          </div>
          <% unless current_page?(controller:"recipes", action: "new") %>
            <div class="description__remove-img-label">
              <%= f.check_box :remove_image %>
              <%= f.label :remove_image %>
            </div>
        <% end %>
      </div>


      <div class="col-md-5 px-sm-0 align-self-center">
        <div class="text-left mt-1 mb-3">
          <h3>レシピについて</h3>
        </div>
        <!--<div class="description__texts">-->
        <!--  <div class="cooking-title">レシピについて</div>-->
        <div class="form-group">
          <%= f.text_field :title, placeholder: "タイトル(50文字以内)", class:"form-control" %>
        </div>
        <div class="form-group">
          <%= f.text_area :description, placeholder: "サブタイトル(140字以内)", class:"form-control introduction" %>
        </div>

        <div class="cooking-title">材料</div>
        <div class="form-group">
          <%= f.fields_for :ingredients do |ingredient| %>
            <%= render "recipes/ingredient_fields", f: ingredient %>
          <% end %>

          <div id="detail-association-insertion-point"></div> <!--追加ボタンを押した後、後に代入される--><!--link_to_add_association フォームの追加-->
          <%= link_to_add_association "材料の追加", f, :ingredients,
          class: "text-white btn btn-warning btn-block mr-2",
          data: {
          association_insertion_node: '#detail-association-insertion-point',
          association_insertion_method: 'before'
          }%>
        </div>
      </div>
    </div>

    <div class="text-left mt-1 mb-3">
      <h3>関連タグ</h3>
    </div>
    <section class="tag">
      <%# 存在するタグの数だけチェックボックスを追加するメソッドを使用 %>
      <div class="tag__container">
        <%= f.collection_check_boxes(:tag_ids, Tag.all, :id, :name) do |tag| %>
          <%= tag.label class: 'tag__item' do %>
            <%= tag.check_box class: 'tag__checkbox' %>
            <%= tag.text %>
          <% end %>
        <% end %>
      </div>
    </section>

    <div class="text-left mt-1 mb-3">
      <h3>作り方</h3>
    </div>
    <section class="step">
      <div class="field">
        <%= f.fields_for :steps do |step| %>
          <%= render "recipes/step_fields", f: step %>
        <% end %>

        <div id="detail-association-insertion-point_step"></div>  <!--追加ボタンを押した後、後に代入される--><!--link_to_add_association フォームの追加-->
          <%= link_to_add_association "作り方の追加", f, :steps,
          class: "text-white btn btn-warning btn-block",
          data: {
          association_insertion_node: '#detail-association-insertion-point_step',
          association_insertion_method: 'before'
          }%>
      </div>
    </section>

    <%= f.submit "送信する", class:"btn btn-outline-success mt-4" %>

    <% end %>
  </div>
</main>